<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HierarQcal Quickstart &mdash; HierarQcal 2023 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/dalle_img.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Core functionality tutorial" href="core_tutorial.html" />
    <link rel="prev" title="Getting Started" href="../getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HierarQcal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#installation">Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../getting_started.html#basic-usage">Basic usage</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">HierarQcal Quickstart</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#binary-trees">Binary trees</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mera-from-grant-et-al">MERA from Grant et al.</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sub-motif-as-a-mapping-for-a-motif">Sub motif as a mapping for a motif</a></li>
<li class="toctree-l4"><a class="reference internal" href="#symbol-management">Symbol management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#masking">Masking</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pivots">Pivots</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specifying-unitaries">Specifying unitaries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="core_tutorial.html">Core functionality tutorial</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HierarQcal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../getting_started.html">Getting Started</a></li>
      <li class="breadcrumb-item active">HierarQcal Quickstart</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/quickstart.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="hierarqcal-quickstart">
<h1>HierarQcal Quickstart<a class="headerlink" href="#hierarqcal-quickstart" title="Permalink to this heading">¶</a></h1>
<p>The idea of this notebook is to quickly showcase different kinds of circuits that can be built with the package. More in depth tutorials are given in other notebooks, this only to functions as a quick view of some functionality.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<img src="https://github.com/matt-lourens/hierarqcal/blob/master/img/dalle_img.png?raw=true" width="300" align="left" style="padding-right:10px">
<p style="height:150px">
<b>HierarQcal</b> is a quantum circuit builder that simplifies circuit design, composition, generation, scaling, and parameter management. It provides an intuitive and dynamic data structure for constructing computation graphs hierarchically. This enables the generation of complex quantum circuit architectures, which is particularly useful for Neural Architecture Search (NAS), where an algorithm can determine the most efficient circuit architecture for a specific task and hardware. HierarQcal also facilitates the creation of hierarchical quantum circuits, such as those resembling tensor tree networks or MERA, with a single line of code. The package is open-source and framework-agnostic, it includes tutorials for Qiskit, PennyLane, and Cirq. Built to address the unique challenges of applying NAS to Quantum Computing, HierarQcal offers a novel approach to explore and optimize quantum circuit architectures. 
</p>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<p><em>A robot building itself with artificial intelligence, pencil drawing -  generated with</em> <a class="reference external" href="https://openai.com/dall-e-2/">Dall E 2</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">hierarqcal</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Qhierarchy</span><span class="p">,</span>
    <span class="n">Qcycle</span><span class="p">,</span>
    <span class="n">Qpermute</span><span class="p">,</span>
    <span class="n">Qmask</span><span class="p">,</span>
    <span class="n">Qunmask</span><span class="p">,</span>
    <span class="n">Qpivot</span><span class="p">,</span>
    <span class="n">Qinit</span><span class="p">,</span>
    <span class="n">Qmotif</span><span class="p">,</span>
    <span class="n">Qmotifs</span><span class="p">,</span>
    <span class="n">plot_motif</span><span class="p">,</span>
    <span class="n">plot_circuit</span><span class="p">,</span>
    <span class="n">Qunitary</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;qiskit&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;qiskit&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">qiskit</span>
    <span class="kn">from</span> <span class="nn">hierarqcal.qiskit.qiskit_circuits</span> <span class="kn">import</span> <span class="n">V2</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">V4</span>

    <span class="k">def</span> <span class="nf">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hierq</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;qiskit&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cirq&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cirq</span>
    <span class="kn">from</span> <span class="nn">cirq.contrib.svg</span> <span class="kn">import</span> <span class="n">SVGCircuit</span>
    <span class="kn">from</span> <span class="nn">hierarqcal.cirq.cirq_circuits</span> <span class="kn">import</span> <span class="n">V2</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">V4</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;matplotlib.font_manager&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">def</span> <span class="nf">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hierq</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cirq&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SVGCircuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pennylane&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
    <span class="kn">from</span> <span class="nn">hierarqcal.pennylane.pennylane_circuits</span> <span class="kn">import</span> <span class="n">V2</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">V4</span>

    <span class="k">def</span> <span class="nf">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">):</span>
        <span class="n">dev</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">hierq</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>

        <span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">hierq</span><span class="o">.</span><span class="n">get_symbols</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">):</span>
                <span class="c1"># Pennylane doesn&#39;t support symbolic parameters, so if no symbols were set (i.e. they are still symbolic), we initialize them randomly</span>
                <span class="n">hierq</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">hierq</span><span class="o">.</span><span class="n">n_symbols</span><span class="p">))</span>
            <span class="n">hierq</span><span class="p">(</span>
                <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;pennylane&quot;</span>
            <span class="p">)</span>  <span class="c1"># This executes the compute graph in order</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">qml</span><span class="o">.</span><span class="n">expval</span><span class="p">(</span><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span><span class="p">(</span><span class="n">wire</span><span class="p">))</span> <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="n">hierq</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">Q</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">circuit</span>

    <span class="k">def</span> <span class="nf">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">draw_mpl</span><span class="p">(</span><span class="n">circuit</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">U2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">V2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">v4</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">V4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="binary-trees">
<h2>Binary trees<a class="headerlink" href="#binary-trees" title="Permalink to this heading">¶</a></h2>
<p>Here are some quick examples of combining cycles with masking patterns that forms binary trees. <code class="docutils literal notranslate"><span class="pre">Qmask</span></code> takes a <code class="docutils literal notranslate"><span class="pre">global_pattern</span></code> argument which is a bitstring where <code class="docutils literal notranslate"><span class="pre">1</span></code> specifies mask (ignore) and <code class="docutils literal notranslate"><span class="pre">0</span></code> specifies don’t mask. Wildcard characters <code class="docutils literal notranslate"><span class="pre">!</span></code> and <code class="docutils literal notranslate"><span class="pre">*</span></code> can be used where <code class="docutils literal notranslate"><span class="pre">!</span></code> fills with ones and <code class="docutils literal notranslate"><span class="pre">*</span></code> with zeros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nq</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">nq</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;*!&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span><span class="o">*</span><span class="n">nq</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/795d397fe947e2659495192d294c5c78b957193b15c9a291fca35d065dd29643.png" src="../_images/795d397fe947e2659495192d294c5c78b957193b15c9a291fca35d065dd29643.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nq</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">nq</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;!*&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span><span class="o">*</span><span class="n">nq</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d8069c8e95016f8c6a94eec226602ff32dd925652573fdb62de7b2eea362370c.png" src="../_images/d8069c8e95016f8c6a94eec226602ff32dd925652573fdb62de7b2eea362370c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nq</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">nq</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;!*!&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span><span class="o">*</span><span class="n">nq</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b9114a7033e15c94db0890b7bc00ea28a8a400b0bbbb06c85cffccb77b28d0df.png" src="../_images/b9114a7033e15c94db0890b7bc00ea28a8a400b0bbbb06c85cffccb77b28d0df.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nq</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">nq</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;*!*&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span><span class="o">*</span><span class="n">nq</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/120e5ed94bf12775d2971ff9d24ccfd44b9254d33a5b9d654ec24ac8357f4d0a.png" src="../_images/120e5ed94bf12775d2971ff9d24ccfd44b9254d33a5b9d654ec24ac8357f4d0a.png" />
</div>
</div>
</div>
<div class="section" id="mera-from-grant-et-al">
<h2>MERA from Grant et al.<a class="headerlink" href="#mera-from-grant-et-al" title="Permalink to this heading">¶</a></h2>
<p>The Multi-scale Entanglement Renormalization Ansatz (MERA) architecture from <a class="reference external" href="https://www.nature.com/articles/s41534-018-0116-9">Hierarchical quantum classifiers, Grant et al.</a>. We generate a N-qubit MERA circuit, change N to 4,8,16,32 to see how simple scaling the same circuit design is. Note that v4 is a 4-qubit unitary, which illustrates how primitves can handle N-qubit unitaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you&#39;re using qiskit you can create Qunitaries with strings</span>
<span class="c1"># u2 = Qunitary(&quot;crx(x)^01&quot;)</span>
<span class="c1"># v4 = Qunitary(&quot;cnot()^01;cnot()^32&quot;)</span>
<span class="n">N</span><span class="o">=</span><span class="mi">8</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">m1</span> <span class="o">=</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;1001&quot;</span><span class="p">,</span> <span class="n">merge_within</span><span class="o">=</span><span class="s2">&quot;1001&quot;</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">boundaries</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open&quot;</span><span class="p">,</span><span class="s2">&quot;open&quot;</span><span class="p">,</span><span class="s2">&quot;open&quot;</span><span class="p">]</span> <span class="p">,</span><span class="n">mapping</span><span class="o">=</span><span class="n">v4</span><span class="p">)</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">c1</span> <span class="o">+</span> <span class="p">(</span><span class="n">m1</span><span class="o">+</span><span class="n">c2</span><span class="p">)</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1307f66b4a3cdda1ce52dfb9a3c7485e4d20a7479e08ebf14fb9d6dc3df66da9.png" src="../_images/1307f66b4a3cdda1ce52dfb9a3c7485e4d20a7479e08ebf14fb9d6dc3df66da9.png" />
</div>
</div>
</div>
<div class="section" id="sub-motif-as-a-mapping-for-a-motif">
<h2>Sub motif as a mapping for a motif<a class="headerlink" href="#sub-motif-as-a-mapping-for-a-motif" title="Permalink to this heading">¶</a></h2>
<div class="section" id="a-cycle-of-cycles">
<h3>A cycle of cycles<a class="headerlink" href="#a-cycle-of-cycles" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">m1</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9f68f84ce691cd58bd36520caba1f3ae23f51ec8f6526d82e44db6b539dc9089.png" src="../_images/9f68f84ce691cd58bd36520caba1f3ae23f51ec8f6526d82e44db6b539dc9089.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/459deb0b4970a3f6d45ae34db1f8606a05c3c06412aef3eca1b24a8a76499ca5.png" src="../_images/459deb0b4970a3f6d45ae34db1f8606a05c3c06412aef3eca1b24a8a76499ca5.png" />
</div>
</div>
</div>
<div class="section" id="a-cycle-of-cycles-of-permutations">
<h3>A cycle of cycles of permutations<a class="headerlink" href="#a-cycle-of-cycles-of-permutations" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsub</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qpermute</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">combinations</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">subsub</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ba41c9cd23c1c1fd33410c44b38ffdc370e6383307ae66cacbf9332f61804368.png" src="../_images/ba41c9cd23c1c1fd33410c44b38ffdc370e6383307ae66cacbf9332f61804368.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sub</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">subsub</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span>
<span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/629411bdca8f483261fafbf5b26a2be52a707a96dc6f899daf823e47faf48120.png" src="../_images/629411bdca8f483261fafbf5b26a2be52a707a96dc6f899daf823e47faf48120.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">sub</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4f96e4fe734d6a5a2698bc32c90210ad670b5afe20c3d565ab0ac3c13ebb9766.png" src="../_images/4f96e4fe734d6a5a2698bc32c90210ad670b5afe20c3d565ab0ac3c13ebb9766.png" />
</div>
</div>
</div>
</div>
<div class="section" id="symbol-management">
<h2>Symbol management<a class="headerlink" href="#symbol-management" title="Permalink to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/053687b7c5dd43731675b9469bd58ed06c2dd6d6dd49e5b61f31b20d8394417e.png" src="../_images/053687b7c5dd43731675b9469bd58ed06c2dd6d6dd49e5b61f31b20d8394417e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f789d5c6fa2b3693b0a04e48fd898db8e143836c033842a00793afe018c720ca.png" src="../_images/f789d5c6fa2b3693b0a04e48fd898db8e143836c033842a00793afe018c720ca.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/21237e29d994e8885b8b638e530a1ec31f30506ba71bfff2c83d26e98c722f2e.png" src="../_images/21237e29d994e8885b8b638e530a1ec31f30506ba71bfff2c83d26e98c722f2e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/459deb0b4970a3f6d45ae34db1f8606a05c3c06412aef3eca1b24a8a76499ca5.png" src="../_images/459deb0b4970a3f6d45ae34db1f8606a05c3c06412aef3eca1b24a8a76499ca5.png" />
</div>
</div>
<div class="section" id="specifying-rotational-angles">
<h3>Specifying rotational angles<a class="headerlink" href="#specifying-rotational-angles" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m1</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hierq</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">hierq</span><span class="o">.</span><span class="n">n_symbols</span><span class="p">))</span>
<span class="nb">list</span><span class="p">(</span><span class="n">hierq</span><span class="o">.</span><span class="n">get_symbols</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[3.568522990845462, 0.8256215855592418]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5f1afe69429fce74837a17757c75b3d9600e2ce350d77a0c474faf9d11af48ae.png" src="../_images/5f1afe69429fce74837a17757c75b3d9600e2ce350d77a0c474faf9d11af48ae.png" />
</div>
</div>
</div>
<div class="section" id="symbols-as-a-function">
<h3>Symbols as a function<a class="headerlink" href="#symbols-as-a-function" title="Permalink to this heading">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nq</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">motif</span> <span class="o">=</span> <span class="n">Qcycle</span>
<span class="c1"># ne is the edge number, i.e. the first edge corresponds to the first unitary in a layer</span>
<span class="c1"># ns is the symbol number which you&#39;ll use for unitaries with multiple symbols</span>
<span class="n">symbol_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">ns</span><span class="p">,</span> <span class="n">ne</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">ne</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span> <span class="o">+</span> <span class="n">motif</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">,</span> <span class="n">share_weights</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">symbol_fn</span><span class="o">=</span><span class="n">symbol_fn</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f38bbdbc87b466a77f71b5486f5f6ce773ef661c67146cca465996082bb07a83.png" src="../_images/f38bbdbc87b466a77f71b5486f5f6ce773ef661c67146cca465996082bb07a83.png" />
</div>
</div>
</div>
</div>
<div class="section" id="masking">
<h2>Masking<a class="headerlink" href="#masking" title="Permalink to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;*!&quot;</span><span class="p">))</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qunmask</span><span class="p">(</span><span class="s2">&quot;previous&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">))</span><span class="o">*</span><span class="mi">3</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fbc60dde09ed01fa86c1be47f745ee9ec28f6a84624c814f725e569c9854a767.png" src="../_images/fbc60dde09ed01fa86c1be47f745ee9ec28f6a84624c814f725e569c9854a767.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The global pattern specifies the outside gets masked. </span>
<span class="c1"># The merge between specifies that the masked qubits connect to the outside ones</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;1**1&quot;</span><span class="p">,</span> <span class="n">merge_between</span><span class="o">=</span><span class="s2">&quot;1*1&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/27dc2cf95f622bc2451dd34cfa57c43fc7bc19e864db06e9393d67a798cabad7.png" src="../_images/27dc2cf95f622bc2451dd34cfa57c43fc7bc19e864db06e9393d67a798cabad7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The global pattern specifies the outside gets masked. </span>
<span class="c1"># The merge between specifies that the masked qubits connect to the inside ones</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;1**1&quot;</span><span class="p">,</span> <span class="n">merge_between</span><span class="o">=</span><span class="s2">&quot;*1*&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/522332171e4cbb4a513f1c4ef29c3dd215dee7b771d590096c0d402bfe7ba292.png" src="../_images/522332171e4cbb4a513f1c4ef29c3dd215dee7b771d590096c0d402bfe7ba292.png" />
</div>
</div>
</div>
<div class="section" id="pivots">
<h2>Pivots<a class="headerlink" href="#pivots" title="Permalink to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qpivot</span><span class="p">(</span>
    <span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;1*&quot;</span><span class="p">,</span>
    <span class="n">merge_within</span><span class="o">=</span><span class="s2">&quot;*1&quot;</span><span class="p">,</span>
    <span class="n">merge_between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">boundaries</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;periodic&quot;</span><span class="p">],</span>
    <span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/898f7d2ac92e2be0d87056fe7419636772d796c5cbff25bd9769b4ac08059ea9.png" src="../_images/898f7d2ac92e2be0d87056fe7419636772d796c5cbff25bd9769b4ac08059ea9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qpivot</span><span class="p">(</span>
    <span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;1*1*&quot;</span><span class="p">,</span>
    <span class="n">merge_within</span><span class="o">=</span><span class="s2">&quot;*1&quot;</span><span class="p">,</span>
    <span class="n">merge_between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">boundaries</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;periodic&quot;</span><span class="p">],</span>
    <span class="n">mapping</span><span class="o">=</span><span class="n">u2</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5d0dea8252329b5103d7057e6082a8ad385716ec9322f0e39d440866594c09cf.png" src="../_images/5d0dea8252329b5103d7057e6082a8ad385716ec9322f0e39d440866594c09cf.png" />
</div>
</div>
</div>
<div class="section" id="specifying-unitaries">
<h2>Specifying unitaries<a class="headerlink" href="#specifying-unitaries" title="Permalink to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;qiskit&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">QuantumRegister</span>
    <span class="k">def</span> <span class="nf">anz1</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="c1"># Assume bits are strings and in the correct QASM format</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">crz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">crx</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">circuit</span>

    <span class="k">def</span> <span class="nf">anz2</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Assume bits are strings and in the correct QASM format</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">circuit</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cirq&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cirq</span>
    <span class="c1"># Masking circuit</span>
    <span class="k">def</span> <span class="nf">anz1</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">controlled_by</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">controlled_by</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">circuit</span>

    <span class="c1"># Cycle circuit</span>
    <span class="k">def</span> <span class="nf">anz2</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">circuit</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pennylane&quot;</span><span class="p">:</span>
    <span class="c1"># Masking circuit</span>
    <span class="k">def</span> <span class="nf">anz1</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CRZ</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">PauliX</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CRX</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>

    <span class="c1"># Cycle circuit</span>
    <span class="k">def</span> <span class="nf">anz2</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RY</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">RZ</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="n">u</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">anz2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">anz1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ansatz_1</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">ansatz_1</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7a00513606de562bbe80f78fe619853ff73b36d8f32a06d7addc4d248c05055b.png" src="../_images/7a00513606de562bbe80f78fe619853ff73b36d8f32a06d7addc4d248c05055b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ansatz_2</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">ansatz_2</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/25a23377d9c3bab7de96bf251272959611cb92af2e7e799fe1e8f6835c6cd0b0.png" src="../_images/25a23377d9c3bab7de96bf251272959611cb92af2e7e799fe1e8f6835c6cd0b0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;*!&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v</span><span class="p">))</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f20bfa7f6fbd6e2b2586ab2a936c1c4fd8e1120850522bfc767ff8387c9c1675.png" src="../_images/f20bfa7f6fbd6e2b2586ab2a936c1c4fd8e1120850522bfc767ff8387c9c1675.png" />
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="core_tutorial.html" class="btn btn-neutral float-right" title="Core functionality tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Matt Lourens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>