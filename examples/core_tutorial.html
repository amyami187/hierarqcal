<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Core functionality tutorial &mdash; HierarQcal 2023 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/dalle_img.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api.html" />
    <link rel="prev" title="HierarQcal Quickstart" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HierarQcal
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#installation">Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../getting_started.html#basic-usage">Basic usage</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="quickstart.html">HierarQcal Quickstart</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Core functionality tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#specify-backend">Specify backend</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-blocks">Building blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qpivot-primitive">Qpivot primitive</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classical-and-quantum-computation-advanced-usage-experimental-features">Classical and Quantum computation (Advanced usage + experimental features)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HierarQcal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../getting_started.html">Getting Started</a></li>
      <li class="breadcrumb-item active">Core functionality tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/core_tutorial.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="core-functionality-tutorial">
<h1>Core functionality tutorial<a class="headerlink" href="#core-functionality-tutorial" title="Permalink to this heading">¶</a></h1>
<p>This notebook will go over each primitive in the package and show their intended use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">hierarqcal</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Qhierarchy</span><span class="p">,</span>
    <span class="n">Qcycle</span><span class="p">,</span>
    <span class="n">Qpermute</span><span class="p">,</span>
    <span class="n">Qpivot</span><span class="p">,</span>
    <span class="n">Qmask</span><span class="p">,</span>
    <span class="n">Qunmask</span><span class="p">,</span>
    <span class="n">Qinit</span><span class="p">,</span>
    <span class="n">Qmotif</span><span class="p">,</span>
    <span class="n">Qmotifs</span><span class="p">,</span>
    <span class="n">Qsplit</span><span class="p">,</span>
    <span class="n">plot_motif</span><span class="p">,</span>
    <span class="n">Qunitary</span><span class="p">,</span>
    <span class="n">plot_circuit</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="specify-backend">
<h2>Specify backend<a class="headerlink" href="#specify-backend" title="Permalink to this heading">¶</a></h2>
<p>It is possible to use the package without a specific backend, but we choose one here for visualisation purposes. We’re mainly going to use the backends plotting functionality to display the circuits, so pick the one you have installed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="s2">&quot;qiskit&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;qiskit&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">qiskit</span>
    <span class="kn">from</span> <span class="nn">hierarqcal.qiskit.qiskit_circuits</span> <span class="kn">import</span> <span class="n">V2</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">V4</span>

    <span class="k">def</span> <span class="nf">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hierq</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;qiskit&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">circuit</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;mpl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cirq&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cirq</span>
    <span class="kn">from</span> <span class="nn">cirq.contrib.svg</span> <span class="kn">import</span> <span class="n">SVGCircuit</span>
    <span class="kn">from</span> <span class="nn">hierarqcal.cirq.cirq_circuits</span> <span class="kn">import</span> <span class="n">V2</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">V4</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;matplotlib.font_manager&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">def</span> <span class="nf">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">hierq</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;cirq&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SVGCircuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pennylane&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
    <span class="kn">from</span> <span class="nn">hierarqcal.pennylane.pennylane_circuits</span> <span class="kn">import</span> <span class="n">V2</span><span class="p">,</span> <span class="n">U2</span><span class="p">,</span> <span class="n">V4</span>

    <span class="k">def</span> <span class="nf">get_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">):</span>
        <span class="n">dev</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">hierq</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">Q</span><span class="p">)</span>

        <span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">circuit</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">hierq</span><span class="o">.</span><span class="n">get_symbols</span><span class="p">(),</span> <span class="kc">False</span><span class="p">),</span> <span class="n">sp</span><span class="o">.</span><span class="n">Symbol</span><span class="p">):</span>
                <span class="c1"># Pennylane doesn&#39;t support symbolic parameters, so if no symbols were set (i.e. they are still symbolic), we initialize them randomly</span>
                <span class="n">hierq</span><span class="o">.</span><span class="n">set_symbols</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">hierq</span><span class="o">.</span><span class="n">n_symbols</span><span class="p">))</span>
            <span class="n">hierq</span><span class="p">(</span>
                <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;pennylane&quot;</span>
            <span class="p">)</span>  <span class="c1"># This executes the compute graph in order</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">qml</span><span class="o">.</span><span class="n">expval</span><span class="p">(</span><span class="n">qml</span><span class="o">.</span><span class="n">PauliZ</span><span class="p">(</span><span class="n">wire</span><span class="p">))</span> <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="n">hierq</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">Q</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">circuit</span>

    <span class="k">def</span> <span class="nf">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">draw_mpl</span><span class="p">(</span><span class="n">circuit</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="building-blocks">
<h2>Building blocks<a class="headerlink" href="#building-blocks" title="Permalink to this heading">¶</a></h2>
<p>Circuit architectures are created by stacking motifs hierarchacially, the lowest level motifs (primitives) are building blocks for higher level ones. On a high level you can regard a primitive as a layer capturing some design motif (cycle, mask, etc) and we’re creating a sequence of layers for the circuit. This view only captures hierarchical architectures of two levels (<em>level 1 -&gt; primitives, level 2 -&gt; sequence of primitves</em>). The framework is more general in that there is no limit to the number of levels used to represent an architecture. See the comparison below:</p>
<p><strong>Layer view</strong></p>
<ul class="simple">
<li><p>architecture = (Cycle, Mask, Cycle, Mask, Cycle, Cycle, Cycle, Mask, Cycle, Mask)</p></li>
</ul>
<p><strong>Hierarchical view</strong></p>
<ul class="simple">
<li><p>m2_1 = (Cycle, Mask)</p></li>
<li><p>m2_2 = (Cycle, Cycle)</p></li>
<li><p>m3_1 = (m2_1, m2_1)</p></li>
<li><p>architecture = (m3_1, m2_2, m3_1)</p></li>
</ul>
 <img src="https://github.com/matt-lourens/hierarqcal/blob/master/img/hierarchical_motifs.drawio.png?raw=true" >
 Consider the figure above, to create the architecture on the right we want to **repeat the alternation between a cycle of stride 1 and masking from bottom to top three times**. The semantic description is simple and intuitive, the package is designed to allow building circuits this way. Notice a cycle of stride 1 and masking from bottom to top are both primitves. Alternating between them, is a level two motif (p1+p2), then repeating that 3 times is a level 3 motif. This gives a concise description of the circuit on the right. The circuit being a binary tree architecture (which is hierarchical).<p>There are two main classes to generate circuit architectures: <code class="docutils literal notranslate"><span class="pre">Qhierarchy</span></code> and <code class="docutils literal notranslate"><span class="pre">Qmotif</span></code>. We call our building blocks primitives, all are instances of <code class="docutils literal notranslate"><span class="pre">Qmotif</span></code>. A primitive is a directed graph with nodes representing qubits and edges unitaries applied between them. The edges are determined by its rules and the number of available qubits. Primitives are stacked with addition or mutliplication operations which act as append and extend, ex: <code class="docutils literal notranslate"><span class="pre">Qcycle()+Qpermute()</span> <span class="pre">=</span> <span class="pre">(Qcycle,Qpermute)</span></code> which is a <code class="docutils literal notranslate"><span class="pre">Qmotifs</span></code> object, a sequence of <code class="docutils literal notranslate"><span class="pre">Qmotif</span></code>. Simlarly <code class="docutils literal notranslate"><span class="pre">Qcycle()*3</span> <span class="pre">=</span> <span class="pre">(Qcycle(),</span> <span class="pre">Qcycle(),</span> <span class="pre">Qcycle)</span></code> is again an instance of <code class="docutils literal notranslate"><span class="pre">Qmotifs</span></code>. Note it’s possible to add motifs together without specifying qubits, when you have a motif ready, it’s initialized with <code class="docutils literal notranslate"><span class="pre">Qinit</span></code> in the following way: <code class="docutils literal notranslate"><span class="pre">Qinit(8)+motif</span></code>. This creates a <code class="docutils literal notranslate"><span class="pre">Qhierarchy</span></code> object, which runs through all the motifs generates their edges.</p>
<p>The types of primitves are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Qcycle</span></code>: Create a cycle of unitaries, sometimes called <code class="docutils literal notranslate"><span class="pre">ladders</span></code> or <code class="docutils literal notranslate"><span class="pre">convolutions</span></code>. It’s hyperparamaters are used to generate cycles in directed graphs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Qpermute</span></code>: unitaries permuted across qubits.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Qmask</span></code>: Mask certain qubits based on a pattern, a mapping can be provided to <em>save</em> it’s information. Also reffered to as <code class="docutils literal notranslate"><span class="pre">entanglers</span></code> or <code class="docutils literal notranslate"><span class="pre">pooling</span></code> layers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Qunmask</span></code>: Unmask previously masked unitaries</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Qinit</span></code>: specify the qubit names, order and amount.</p></li>
</ul>
<div class="section" id="qunitary">
<h3>Qunitary<a class="headerlink" href="#qunitary" title="Permalink to this heading">¶</a></h3>
<p>The edges of primitves encode the connectivity of the unitary, 1-qubit unitaries correspond to edges with arity 1 (1-ary tuples primitive.E=[(1,),(2),,…]). 2 qubit unitaries correspond to 2-ary tuples primitive.E=[(1,2),(3,4),…] and <code class="docutils literal notranslate"><span class="pre">N</span></code>-qubit unitaries to N-ary tuples ex: primitive.E=[(1,2,…,7),(3,4,…,8),…]. <code class="docutils literal notranslate"><span class="pre">Qunitary</span></code> tells a primitive the arity of it’s operation, each primitive has a mapping hyperparamater that expects a <code class="docutils literal notranslate"><span class="pre">Qunitary</span></code> object. The arguments for <code class="docutils literal notranslate"><span class="pre">Qunitary</span></code> are:</p>
<ul class="simple">
<li><p>function: the function that get’s executed at every edge</p></li>
<li><p>n_symbols: the number of symbols the function expects</p></li>
<li><p>arity: the arity of the function (number of qubits it acts upon)</p></li>
</ul>
<p>Notice that any function is permitted, there is no restriction to unitarity or even quantumness. In this sense the package is a dynamic datatrstructe to construct of hierarchichal compute graphs, but we work mainly in the context of quantum computing. This is also why the packages is framework agnostic, since no matter the framework, you will be able to create a function that does it’s circuit execution. HierarQcal manages the order in which these circuits get executed (well it generates the order, and number of executions.). For creating architectures, we only need to know the arity and number of symbols our function expects. This way, you can generate a circuit architecture without specifying the specific function corresponding to a unitary and framework. Once the architecture is ready, you can specify the functions and execute it on a backend by calling <code class="docutils literal notranslate"><span class="pre">hierq(backend=&quot;qiskit&quot;)</span></code> where <code class="docutils literal notranslate"><span class="pre">hierq</span></code> is the <code class="docutils literal notranslate"><span class="pre">Qhierarchy</span></code> object containing the architecture (or more generally, the compute graph).</p>
<p>For the examples below, we specify an arbitrary <code class="docutils literal notranslate"><span class="pre">Qunitary</span></code> object with no specific function connected to it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">u0_1</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_symbols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">u0_2</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_symbols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">u1_2</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_symbols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">u2_3</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_symbols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">u2_4</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">function</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_symbols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">arity</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="qinit-primitive">
<h3>Qinit primitive<a class="headerlink" href="#qinit-primitive" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Qinit</span></code> is a special primitive with no operational effect. It initializes a set of qubit labels as reference for operations. <code class="docutils literal notranslate"><span class="pre">Qinit</span></code> is always provided at the start of a statement ex: <code class="docutils literal notranslate"><span class="pre">Qinit(3)+motifs</span></code> which causes a <code class="docutils literal notranslate"><span class="pre">Qhierarchy</span></code> object to be created. <code class="docutils literal notranslate"><span class="pre">Qhierarchy</span></code> manages the edge creation of motifs. Use <code class="docutils literal notranslate"><span class="pre">Qinit</span></code> is usually used in the final statement combining all motifs into an architecture or in statements that create sub hierarchies. Providing an integer $n$ labels the qubits $1, 2, \dots, n$, but providing a list with specific qubit order is also possible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_primitive</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_motif</span><span class="p">(</span><span class="n">init_primitive</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/356eafc6b56dc727a4fb973e364f839f4fc86216cd11f2113f7eae44df73e5f8.png" src="../_images/356eafc6b56dc727a4fb973e364f839f4fc86216cd11f2113f7eae44df73e5f8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_primitive</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_motif</span><span class="p">(</span><span class="n">init_primitive</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f063506b85333c05fcda4582e14beefe73e6ba97e2dc913b0fbf02b464a5712a.png" src="../_images/f063506b85333c05fcda4582e14beefe73e6ba97e2dc913b0fbf02b464a5712a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_primitive</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">([</span><span class="s2">&quot;q1&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">])</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_motif</span><span class="p">(</span><span class="n">init_primitive</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0b97959a438bb9a8fd8b417856ad547ffc0cf2138f938281d3d964c17ec478a2.png" src="../_images/0b97959a438bb9a8fd8b417856ad547ffc0cf2138f938281d3d964c17ec478a2.png" />
</div>
</div>
</div>
<div class="section" id="cycle-primitive">
<h3>Cycle primitive<a class="headerlink" href="#cycle-primitive" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Qcycle</span></code> is a primitve that creates a cycle or ladder or convolution of unitaries. It has four main hyperparameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">stride</span></code>: The number of nodes to skip, before connecting the edge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code>: The number of nodes to step over after the edge was connected</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code>: The node to start the procedure with</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boundary</span></code>: The boundary condition of the cycle, can be <code class="docutils literal notranslate"><span class="pre">open</span></code> or <code class="docutils literal notranslate"><span class="pre">periodic</span></code>
The action is best seen through examples, but the general procedure for edge creation is staring at <code class="docutils literal notranslate"><span class="pre">offset</span></code> step in units of <code class="docutils literal notranslate"><span class="pre">step</span></code> at each <code class="docutils literal notranslate"><span class="pre">step</span></code> connect to <code class="docutils literal notranslate"><span class="pre">stride</span></code> units away.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convolution of stride 3, try out other stride values</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle_on_8_qubits</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>

<span class="c1"># Note the type of &#39;conv_on_8_qubits&#39;, it&#39;s a qcnn with two motifs: (Qfree, Qconv)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Type of object</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">cycle_on_8_qubits</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First motif</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">cycle_on_8_qubits</span><span class="o">.</span><span class="n">tail</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Second motif</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">cycle_on_8_qubits</span><span class="o">.</span><span class="n">tail</span><span class="o">.</span><span class="n">next</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Type of object	 &lt;class &#39;hierarqcal.core.Qhierarchy&#39;&gt;
First motif	 &lt;class &#39;hierarqcal.core.Qinit&#39;&gt;
Second motif	 &lt;class &#39;hierarqcal.core.Qcycle&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle_on_8_qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle_on_8_qubits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 400x400 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
<img alt="../_images/0355f53fb6af8443b97503a79f0cad9f319998d38b4bb8a5515e25c4335b7571.png" src="../_images/0355f53fb6af8443b97503a79f0cad9f319998d38b4bb8a5515e25c4335b7571.png" />
<img alt="../_images/41694ce53ba8fffa4316f02a1f3f53caad9bb2809a022151cd19c7ce609b0973.png" src="../_images/41694ce53ba8fffa4316f02a1f3f53caad9bb2809a022151cd19c7ce609b0973.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># There is a minimal circuit plotter which converts the sequence of digraph into a two dimensional view.</span>
<span class="c1"># Notice no specific unitary needs to be specified, it&#39;s seen as a black box where we&#39;re only building the connectivity.</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle_on_8_qubits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/85fd9f146526cb6b2900e8b45eff7aa0b68a12dc364ac20a76428e7001d84239.png" src="../_images/85fd9f146526cb6b2900e8b45eff7aa0b68a12dc364ac20a76428e7001d84239.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="section" id="stride-examples">
<h4>Stride examples<a class="headerlink" href="#stride-examples" title="Permalink to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/72eacff884561cb138184655d0a329663a473e8c3a2e7f9b47dc7f703f4bf22e.png" src="../_images/72eacff884561cb138184655d0a329663a473e8c3a2e7f9b47dc7f703f4bf22e.png" />
<img alt="../_images/a87f4bdf5aee954d0821d3245a9505497409c780ca7dea7b2d85a0838f10b056.png" src="../_images/a87f4bdf5aee954d0821d3245a9505497409c780ca7dea7b2d85a0838f10b056.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0c7aab2ce478aab96057b02526f1728141872a276098da843ff0567f3e470010.png" src="../_images/0c7aab2ce478aab96057b02526f1728141872a276098da843ff0567f3e470010.png" />
<img alt="../_images/06202980d8d5d8735bab19b22865734f4f1db6ea48d296f6956f0e87b6db3654.png" src="../_images/06202980d8d5d8735bab19b22865734f4f1db6ea48d296f6956f0e87b6db3654.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/09dd8cc827052b6217d37eeffa481c57027c89d39457ed7eb969388cce856dfc.png" src="../_images/09dd8cc827052b6217d37eeffa481c57027c89d39457ed7eb969388cce856dfc.png" />
<img alt="../_images/fd1cec4b67801e0a9486e8532a97ffc8e3b3f0c1aae0b129b52b5fa6c0d079ae.png" src="../_images/fd1cec4b67801e0a9486e8532a97ffc8e3b3f0c1aae0b129b52b5fa6c0d079ae.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="step-examples">
<h4>Step examples<a class="headerlink" href="#step-examples" title="Permalink to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/dc1ce262ff543035e6c3414ab7635ca6aa513c3408686c5289d6d96a158905a2.png" src="../_images/dc1ce262ff543035e6c3414ab7635ca6aa513c3408686c5289d6d96a158905a2.png" />
<img alt="../_images/4f0b0a2d9f1cae0698544e2217060c1983f6e1685a0ba55a35f1c2cee5fcbb79.png" src="../_images/4f0b0a2d9f1cae0698544e2217060c1983f6e1685a0ba55a35f1c2cee5fcbb79.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b42a0a46c8f41762180d89081c8627e2cecb9f6e29a988c08d9fcc4f8dbfbcab.png" src="../_images/b42a0a46c8f41762180d89081c8627e2cecb9f6e29a988c08d9fcc4f8dbfbcab.png" />
<img alt="../_images/7109266347b645b331f042ed033d0be782bb7082bce38308993dc9377b75fba1.png" src="../_images/7109266347b645b331f042ed033d0be782bb7082bce38308993dc9377b75fba1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bdf82200084844f9a2b366bbe39dd52e32502f7bdeefbec33eec925402617b8a.png" src="../_images/bdf82200084844f9a2b366bbe39dd52e32502f7bdeefbec33eec925402617b8a.png" />
<img alt="../_images/03f441ce001b2f55baf02a1d40363a760f4f62a99bffc7efcaad7a49df21393b.png" src="../_images/03f441ce001b2f55baf02a1d40363a760f4f62a99bffc7efcaad7a49df21393b.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="offset-examples">
<h4>Offset examples<a class="headerlink" href="#offset-examples" title="Permalink to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6f6b55dcc363ed962939abb17fc4f4981a3f715122c1968b13d50823b140a75e.png" src="../_images/6f6b55dcc363ed962939abb17fc4f4981a3f715122c1968b13d50823b140a75e.png" />
<img alt="../_images/03b3f596f0ff66314896b445c29ef742afb9fbec9692c45fcb012b7b15e70c6e.png" src="../_images/03b3f596f0ff66314896b445c29ef742afb9fbec9692c45fcb012b7b15e70c6e.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9bc22c71d23d627464a04abd05cca1ecedc88e231842fca0f15b057ed91b802e.png" src="../_images/9bc22c71d23d627464a04abd05cca1ecedc88e231842fca0f15b057ed91b802e.png" />
<img alt="../_images/845203da8ea4eb77745832b3d88a86e5be8210f81c4520337c91f05bf255a799.png" src="../_images/845203da8ea4eb77745832b3d88a86e5be8210f81c4520337c91f05bf255a799.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="boundary-examples">
<h4>Boundary examples<a class="headerlink" href="#boundary-examples" title="Permalink to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab98576d4100ef02d6bf164fe7f2a0381f24f600d68da7b74d5583e6ef4542ca.png" src="../_images/ab98576d4100ef02d6bf164fe7f2a0381f24f600d68da7b74d5583e6ef4542ca.png" />
<img alt="../_images/d0e9437850998f7a8e0178ccfcf1af75f2a5f9804e58462d13ef9bd6bebafaae.png" src="../_images/d0e9437850998f7a8e0178ccfcf1af75f2a5f9804e58462d13ef9bd6bebafaae.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/76df75aef7c9ae02e69d30d373924680c0e207cabf9be4f9541d3572ffc35f43.png" src="../_images/76df75aef7c9ae02e69d30d373924680c0e207cabf9be4f9541d3572ffc35f43.png" />
<img alt="../_images/410b7713f335c80c8f48711f8ba2eaa29ba1aa0c23dbf27b05330c90fa0aaa59.png" src="../_images/410b7713f335c80c8f48711f8ba2eaa29ba1aa0c23dbf27b05330c90fa0aaa59.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;periodic&quot;</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">cycle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/41694ce53ba8fffa4316f02a1f3f53caad9bb2809a022151cd19c7ce609b0973.png" src="../_images/41694ce53ba8fffa4316f02a1f3f53caad9bb2809a022151cd19c7ce609b0973.png" />
<img alt="../_images/85fd9f146526cb6b2900e8b45eff7aa0b68a12dc364ac20a76428e7001d84239.png" src="../_images/85fd9f146526cb6b2900e8b45eff7aa0b68a12dc364ac20a76428e7001d84239.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="n-qubit-unitaries">
<h4>N qubit unitaries<a class="headerlink" href="#n-qubit-unitaries" title="Permalink to this heading">¶</a></h4>
<p>For N-qubit unitaries other than N=2, the cycle primitive becomes a hypergraph. <code class="docutils literal notranslate"><span class="pre">stride</span></code>, <code class="docutils literal notranslate"><span class="pre">step</span></code> and <code class="docutils literal notranslate"><span class="pre">offset</span></code> still has the same meaning but now the edges are N-ary tuples. For example a stride of 3 causes edges of the form (1,4,7) for a 3-qubit unitary. This means the function gets sent bits 1,4,7 in that order. Consider the same 3 qubit unitary defined with pennylane, qiskit or cirq</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;qiskit&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">QuantumRegister</span>
    <span class="k">def</span> <span class="nf">U3</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">crz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">crx</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">q2</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">circuit</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cirq&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cirq</span>
    <span class="k">def</span> <span class="nf">U3</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">rz</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">controlled_by</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">rx</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">controlled_by</span><span class="p">(</span><span class="n">q2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">circuit</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pennylane&quot;</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">U3</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CRZ</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CRX</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">u3</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">U3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u3</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/df402765a84fc18c0e0e04216ff02e1381e45194fc91ad7a387b55d6cfb2bcdf.png" src="../_images/df402765a84fc18c0e0e04216ff02e1381e45194fc91ad7a387b55d6cfb2bcdf.png" />
<img alt="../_images/5f59983b9c7042126858cf9370d601b71629d2d9ddf4bb27716a6ea0d0c75283.png" src="../_images/5f59983b9c7042126858cf9370d601b71629d2d9ddf4bb27716a6ea0d0c75283.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u3</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0defb6d7f7fa7dd94c11581742550db79f8cd5fb81c29e248e585e6fad8a95d3.png" src="../_images/0defb6d7f7fa7dd94c11581742550db79f8cd5fb81c29e248e585e6fad8a95d3.png" />
<img alt="../_images/9effbdd155a40bc9b0af9c792ca849928fe1d67a23f611b86460e7d026b1c67b.png" src="../_images/9effbdd155a40bc9b0af9c792ca849928fe1d67a23f611b86460e7d026b1c67b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle</span> <span class="o">=</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u3</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="n">cycle</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">cycle</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/db827f52a278a050a9206bdd7e5c81b20ecec22d8ab8c0b890d29808fc00d2b6.png" src="../_images/db827f52a278a050a9206bdd7e5c81b20ecec22d8ab8c0b890d29808fc00d2b6.png" />
<img alt="../_images/ee8ff3652289eaf31ffc2fbbc3d59e884268ac89cd0b7f3975d8d2cc6bc2af3c.png" src="../_images/ee8ff3652289eaf31ffc2fbbc3d59e884268ac89cd0b7f3975d8d2cc6bc2af3c.png" />
</div>
</div>
</div>
</div>
<div class="section" id="qpermute-primitive">
<h3>Qpermute primitive<a class="headerlink" href="#qpermute-primitive" title="Permalink to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Qpermute</span></code> is a simple primitive that generates all combinations or permutations of edges based on the <code class="docutils literal notranslate"><span class="pre">combinations</span></code> hyperparameter and <code class="docutils literal notranslate"><span class="pre">arity</span></code> of corresponding function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combinations</span><span class="p">:</span>
    <span class="n">E</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arity</span><span class="p">))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">E</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="o">.</span><span class="n">permutations</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">arity</span><span class="p">))</span>
</pre></div>
</div>
<p>Where E is the generated edges and Q the available qubits of the primitive</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permute</span> <span class="o">=</span> <span class="n">Qpermute</span><span class="p">()</span>
<span class="n">permute_5_qubits</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">permute</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">permute_5_qubits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">permute_5_qubits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ff790f6ae04042f2ad4c6563019f996ff430d6cf046e7c9bf72e381b01f2981c.png" src="../_images/ff790f6ae04042f2ad4c6563019f996ff430d6cf046e7c9bf72e381b01f2981c.png" />
<img alt="../_images/cad802396ca493b1ac71c6e282bb62f2360f29f6ba75613e798c2d1d700ac999.png" src="../_images/cad802396ca493b1ac71c6e282bb62f2360f29f6ba75613e798c2d1d700ac999.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permute</span> <span class="o">=</span> <span class="n">Qpermute</span><span class="p">(</span><span class="n">combinations</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">permute_5_qubits</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">permute</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">permute_5_qubits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">permute_5_qubits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/63aeae20a95a492364354fa725105b3323c7a24f6c7750b8c8aa37ab41932042.png" src="../_images/63aeae20a95a492364354fa725105b3323c7a24f6c7750b8c8aa37ab41932042.png" />
<img alt="../_images/62aaed4d1e9a6848658651da3631b45917b29cf656a8b60cb5712bd270eb1dfa.png" src="../_images/62aaed4d1e9a6848658651da3631b45917b29cf656a8b60cb5712bd270eb1dfa.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">permute</span> <span class="o">=</span> <span class="n">Qpermute</span><span class="p">(</span><span class="n">combinations</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u2_3</span><span class="p">)</span>
<span class="n">permute_5_qubits</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">permute</span>
<span class="nb">print</span><span class="p">(</span><span class="n">permute_5_qubits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(1, 2, 3), (1, 2, 4), (1, 2, 5), (1, 3, 2), (1, 3, 4), (1, 3, 5), (1, 4, 2), (1, 4, 3), (1, 4, 5), (1, 5, 2), (1, 5, 3), (1, 5, 4), (2, 1, 3), (2, 1, 4), (2, 1, 5), (2, 3, 1), (2, 3, 4), (2, 3, 5), (2, 4, 1), (2, 4, 3), (2, 4, 5), (2, 5, 1), (2, 5, 3), (2, 5, 4), (3, 1, 2), (3, 1, 4), (3, 1, 5), (3, 2, 1), (3, 2, 4), (3, 2, 5), (3, 4, 1), (3, 4, 2), (3, 4, 5), (3, 5, 1), (3, 5, 2), (3, 5, 4), (4, 1, 2), (4, 1, 3), (4, 1, 5), (4, 2, 1), (4, 2, 3), (4, 2, 5), (4, 3, 1), (4, 3, 2), (4, 3, 5), (4, 5, 1), (4, 5, 2), (4, 5, 3), (5, 1, 2), (5, 1, 3), (5, 1, 4), (5, 2, 1), (5, 2, 3), (5, 2, 4), (5, 3, 1), (5, 3, 2), (5, 3, 4), (5, 4, 1), (5, 4, 2), (5, 4, 3)]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="qmask-and-qunmask-primitive">
<h3>Qmask and Qunmask primitive<a class="headerlink" href="#qmask-and-qunmask-primitive" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Qmask</span></code> primitive allows you to “mask” qubits according to a chosen pattern. Masking qubits in this context implies rendering certain qubits temporarily unavailable for subsequent operations, which facilitates specialized architectures and computations. You have the option to associate a unitary operation with the mask. The utility of this is that it “preserves” the information of the masked qubits, usually through a controlled unitary operation. This feature enables patterns of pooling in quantum neural networks, coarse graining,  entanglers and “deferred measurement” where masked qubits are the controls of unmasked ones.</p>
<p>For 2-qubit unitaries there are predefined masking patterns such as “right”, “left”, “inside”, “outside”, “even”, “odd” which halves the circuit size. Alternatively, you can provide your own string such as “1*1” where ‘1’ signifies mask and “*” means to fill with 0’s based on the number of available qubits. ‘0’ signifies keeping the qubit active.</p>
<p>When specifying a unitary, there are three <code class="docutils literal notranslate"><span class="pre">connection_type</span></code> options (how to generate the edges):</p>
<ul class="simple">
<li><p>“cycle”, simlar to the cycle primitive, generate edges with a stride, step and offset parameter</p></li>
<li><p>“nearest_circle” connect each masked qubit to the nearest available qubit in a circular topology</p></li>
<li><p>“nearest_tower”  connect each masked qubit to the nearest available qubit in a tower topology</p></li>
</ul>
<p>The Qunmask primitive allows you to “unmask” previously masked qubits, making them available for subsequent operations.</p>
<p>Examples will make this clearer:</p>
<div class="section" id="masking-without-a-mapping">
<h4>Masking without a mapping<a class="headerlink" href="#masking-without-a-mapping" title="Permalink to this heading">¶</a></h4>
<p>The small nodes are the masked ones</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/694097820f124d8b7492eeeee10a3e5fd92a8b70c9ba9106633468c5d0dbf969.png" src="../_images/694097820f124d8b7492eeeee10a3e5fd92a8b70c9ba9106633468c5d0dbf969.png" />
<img alt="../_images/c36a73306bf550f60759e941d480617b65405fd782f4e5b4cfc85ed81afd6865.png" src="../_images/c36a73306bf550f60759e941d480617b65405fd782f4e5b4cfc85ed81afd6865.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;01&quot;</span><span class="p">)</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/28a93e085ae3eb2060857ce811425621a14be94e8f52a5dda8cee5f8df4a3ae4.png" src="../_images/28a93e085ae3eb2060857ce811425621a14be94e8f52a5dda8cee5f8df4a3ae4.png" />
<img alt="../_images/54bdb88f2b687c083cddf7e7b507c604234eca16bec8e81c5e626b61628d8c98.png" src="../_images/54bdb88f2b687c083cddf7e7b507c604234eca16bec8e81c5e626b61628d8c98.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<p>This might be easier to see with a circuit and a mask between two cycles. We’ll use the following 2 qubit unitaries for the cycles:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;01&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/78f201132e77436358dde78d02d7dea676d04eac1a6344b1d9ec0625f0dfe753.png" src="../_images/78f201132e77436358dde78d02d7dea676d04eac1a6344b1d9ec0625f0dfe753.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3e4fb11253c476fdbba895636caac8e8cf42bf1d6ef258d06bcf43bbcf50e304.png" src="../_images/3e4fb11253c476fdbba895636caac8e8cf42bf1d6ef258d06bcf43bbcf50e304.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;1*1&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">))</span><span class="o">*</span><span class="mi">3</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3ea6465308bd0645f3f62de0cfa9f5c12938c393d05f3429b626ead9888e28b2.png" src="../_images/3ea6465308bd0645f3f62de0cfa9f5c12938c393d05f3429b626ead9888e28b2.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="masking-with-a-mapping">
<h4>Masking with a mapping<a class="headerlink" href="#masking-with-a-mapping" title="Permalink to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/87792a2305465a55ddba4690db07febc506421e12029e6fe9614da8dac716f07.png" src="../_images/87792a2305465a55ddba4690db07febc506421e12029e6fe9614da8dac716f07.png" />
<img alt="../_images/35a401999f67475976e2be32c64a21f74b78d76d9a743e48d430ce4bf2d269c2.png" src="../_images/35a401999f67475976e2be32c64a21f74b78d76d9a743e48d430ce4bf2d269c2.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ec5a82d6dbd4f96a22fe071efca56bb503bff5f131dd0a5cb8796d2d6c2bb6b9.png" src="../_images/ec5a82d6dbd4f96a22fe071efca56bb503bff5f131dd0a5cb8796d2d6c2bb6b9.png" />
<img alt="../_images/f452bdb1aec5106a550af0c4573e9dd234a10a10f1d29b7120a9950898c2b3c0.png" src="../_images/f452bdb1aec5106a550af0c4573e9dd234a10a10f1d29b7120a9950898c2b3c0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;*!&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b412a9aeb8846e78779de12f5fb5fe029799f396e919abb54c7305c39cf83a1d.png" src="../_images/b412a9aeb8846e78779de12f5fb5fe029799f396e919abb54c7305c39cf83a1d.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;1*&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">))</span><span class="o">*</span><span class="mi">6</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c7a6a26f0218fe8b89986e12c92a5e9bcd6cffa3cc72ab2db4fbdcac33cd17a7.png" src="../_images/c7a6a26f0218fe8b89986e12c92a5e9bcd6cffa3cc72ab2db4fbdcac33cd17a7.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h4>N-qubit unitaries<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h4>
<p>For N qubit unitaries, the pattern provided applies within the unitary. For example a pattern of “101” means for each edge of the form (a,b,c), a and c are going to be masked. Therefore the pattern string needs to be the same length as the arity for N&gt;2 unitaries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;qiskit&quot;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">qiskit.circuit</span> <span class="kn">import</span> <span class="n">QuantumRegister</span>
    <span class="k">def</span> <span class="nf">V3</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">cnot</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">circuit</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;cirq&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cirq</span>
    <span class="k">def</span> <span class="nf">V3</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">circuit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">cirq</span><span class="o">.</span><span class="n">LineQubit</span><span class="p">(</span><span class="n">bits</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q0</span><span class="p">)</span>
        <span class="n">circuit</span> <span class="o">+=</span> <span class="n">cirq</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">circuit</span>

<span class="k">elif</span> <span class="n">backend</span> <span class="o">==</span> <span class="s2">&quot;pennylane&quot;</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">V3</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="n">qml</span><span class="o">.</span><span class="n">CNOT</span><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">v3</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">V3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;101&quot;</span><span class="p">,</span><span class="n">merge_within</span><span class="o">=</span><span class="s2">&quot;101&quot;</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">v3</span><span class="p">)</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">get_circuit</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="n">draw_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/132f24287b3e1feb31fcdbb566c60d3829913b499fef9d0f7060618b1bb3d030.png" src="../_images/132f24287b3e1feb31fcdbb566c60d3829913b499fef9d0f7060618b1bb3d030.png" />
<img alt="../_images/a056c981b4d786d267af8e511fc7b189f716f22d858a2a35c89761fc282e4878.png" src="../_images/a056c981b4d786d267af8e511fc7b189f716f22d858a2a35c89761fc282e4878.png" />
</div>
</div>
</div>
<div class="section" id="qunmask-example">
<h4>Qunmask example<a class="headerlink" href="#qunmask-example" title="Permalink to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qmask</span><span class="p">(</span><span class="s2">&quot;*!&quot;</span><span class="p">))</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span> <span class="p">(</span><span class="n">Qunmask</span><span class="p">(</span><span class="s2">&quot;previous&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">u0_2</span><span class="p">))</span><span class="o">*</span><span class="mi">3</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fe6137c87ccc5d559c017d847303b28a0ded2cfbbb3f92d33e12c9fae3721790.png" src="../_images/fe6137c87ccc5d559c017d847303b28a0ded2cfbbb3f92d33e12c9fae3721790.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="qpivot-primitive">
<h2>Qpivot primitive<a class="headerlink" href="#qpivot-primitive" title="Permalink to this heading">¶</a></h2>
<p>Qpivot is new, and this part of the tutorial will still get fleshed out. The pivot primitve connects the set of available qubits sequentially to a fixed set of qubits. The global pattern determines the pivot points while the merge pattern determines how the qubits are passed to the mapping. For detailed usage please see the grover and qft tutorials. Here are some quick examples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hierq</span> <span class="o">=</span> <span class="n">Qinit</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">Qpivot</span><span class="p">(</span>
    <span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;1*&quot;</span><span class="p">,</span>
    <span class="n">merge_within</span><span class="o">=</span><span class="s2">&quot;*1&quot;</span><span class="p">,</span>
    <span class="n">merge_between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">strides</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">offsets</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">boundaries</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;periodic&quot;</span><span class="p">],</span>
    <span class="n">mapping</span><span class="o">=</span><span class="n">u1_2</span><span class="p">)</span>
<span class="n">plot_motif</span><span class="p">(</span><span class="n">hierq</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b4b88e61c16af597285c82e1d071cc5b13f3e6f3d5492dd8c9d011a2f83e4418.png" src="../_images/b4b88e61c16af597285c82e1d071cc5b13f3e6f3d5492dd8c9d011a2f83e4418.png" />
<img alt="../_images/6a21207af87539fb16dc2a85d279a8c0f4c66395a9aa4da65df389bbcccb0b88.png" src="../_images/6a21207af87539fb16dc2a85d279a8c0f4c66395a9aa4da65df389bbcccb0b88.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="classical-and-quantum-computation-advanced-usage-experimental-features">
<h2>Classical and Quantum computation (Advanced usage + experimental features)<a class="headerlink" href="#classical-and-quantum-computation-advanced-usage-experimental-features" title="Permalink to this heading">¶</a></h2>
<p>At the end of the day we are just building a compute graph in a hierarchichal manner with these primitves. For this reason we aren’t limited to quantum computation and can create classical algorithms also. This section will show how this can be achieved. We’ll also show how a naive quantum state vector simulation can be performed.</p>
<div class="section" id="classical-computation-addition-example">
<h3>Classical computation (addition example)<a class="headerlink" href="#classical-computation-addition-example" title="Permalink to this heading">¶</a></h3>
<p>Here is a completely classical computation for arbitrary integer addition. Notice we define two functions (half_adder and or_top) which changes a <code class="docutils literal notranslate"><span class="pre">state</span></code> variable directly (no matrix multiplication, just logic and overwriting, similar to classical circuits). The state is initialised with Qinit, then hierarqcal just executes these functions in the correct order. So you can create any function that changes the <code class="docutils literal notranslate"><span class="pre">state</span></code> as you desire.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">half_adder</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">state</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">xor</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">^</span> <span class="n">b2</span>
    <span class="n">carry</span> <span class="o">=</span> <span class="n">b1</span> <span class="ow">and</span> <span class="n">b2</span>
    <span class="n">state</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">carry</span>
    <span class="n">state</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">xor</span>
    <span class="k">return</span> <span class="n">state</span>


<span class="k">def</span> <span class="nf">or_top</span><span class="p">(</span><span class="n">bits</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">state</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">state</span><span class="p">[</span><span class="n">bits</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">b1</span> <span class="ow">or</span> <span class="n">b2</span>
    <span class="k">return</span> <span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">512</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">512</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]]</span>
<span class="n">bits</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bits</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">bits</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="n">x</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">bits</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># program</span>
<span class="n">full_adder</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Qinit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">half_adder</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Qpivot</span><span class="p">(</span><span class="n">global_pattern</span><span class="o">=</span><span class="s2">&quot;1*&quot;</span><span class="p">,</span> <span class="n">merge_within</span><span class="o">=</span><span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">or_top</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">addition</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Qinit</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)],</span> <span class="n">state</span><span class="o">=</span><span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">])</span>
    <span class="o">+</span> <span class="n">Qpivot</span><span class="p">(</span><span class="s2">&quot;*1&quot;</span><span class="p">,</span> <span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">half_adder</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Qcycle</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">edge_order</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">full_adder</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;open&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plot_circuit</span><span class="p">(</span><span class="n">addition</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b61df78f4b01db8b3fbc924936f7416650d88dd47c65185a39044766de4bc9ed.png" src="../_images/b61df78f4b01db8b3fbc924936f7416650d88dd47c65185a39044766de4bc9ed.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&lt;Figure size 1000x600 with 1 Axes&gt;, &lt;AxesSubplot:&gt;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the answer, we generate a bitstring and then turn it into a function that return only the array items with corresponding index 1</span>
<span class="c1"># Qsplit is a lower level primitve that Qmask and Qpivot inherhtis from, the bitstrings we generate for them also gets turned into functions via get_pattern_fn</span>
<span class="c1"># Don&#39;t run this twice! then you won&#39;t get the correct answer</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">addition</span><span class="p">()</span>
<span class="n">pattern_fn</span> <span class="o">=</span> <span class="n">Qsplit</span><span class="o">.</span><span class="n">get_pattern_fn</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s2">&quot;1&quot;</span> <span class="o">+</span> <span class="s2">&quot;01&quot;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">n</span>
<span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">pattern_fn</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">sum</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))])</span><span class="si">}</span>
<span class="s2">        +</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">sum</span><span class="p">([</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))])</span><span class="si">}</span>
<span class="s2">        =</span>
<span class="s2">        </span><span class="si">{</span><span class="nb">sum</span><span class="p">([</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">))])</span><span class="si">}</span>
<span class="s2">    &quot;&quot;&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        350
        +
        82
        =
        432
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lower-level-control-create-your-own-edge-patterns-custom-quantum-simulation">
<h3>Lower level control (create your own edge patterns) + custom Quantum simulation<a class="headerlink" href="#lower-level-control-create-your-own-edge-patterns-custom-quantum-simulation" title="Permalink to this heading">¶</a></h3>
<p>Below we are show two things at the same time, first how you can specify individual edges to the <code class="docutils literal notranslate"><span class="pre">Qmotif</span></code> primitive. Depending on the <code class="docutils literal notranslate"><span class="pre">arity</span></code>, <code class="docutils literal notranslate"><span class="pre">E</span></code> is a list of <code class="docutils literal notranslate"><span class="pre">arity</span></code>-tuples which you can generate. For example <code class="docutils literal notranslate"><span class="pre">E=[(0,2,4),(1,3,5)]</span></code> means your <code class="docutils literal notranslate"><span class="pre">Qunitary</span></code> function takes 3 inputs (<code class="docutils literal notranslate"><span class="pre">arity</span></code>=3) and will apply the function to <code class="docutils literal notranslate"><span class="pre">bits</span></code> 0,2,4 and 1,3,5 seperatly, in the order that’s provided. This will works for 3rd party quantum packages (so you can do this with Qiskit, Cirq, or Pennylane). We’re combining this with a custom circuit simulation where we perform tensor contraction to calculate the final state vector. This way it’s possible to simulate qutrits, qudits or even more general tensor networks.</p>
<p>This is a quick demonstration, for details check out <code class="docutils literal notranslate"><span class="pre">Qhierarchy.__call__</span></code> method in <code class="docutils literal notranslate"><span class="pre">core.py</span></code> and <code class="docutils literal notranslate"><span class="pre">get_tensor_as_f</span></code> in <code class="docutils literal notranslate"><span class="pre">utils.py</span></code></p>
<p>The code below creates a Toffoli gate, we apply two bitflips on the first two qubits to see if the third will be flipped.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hierarqcal</span> <span class="kn">import</span> <span class="n">get_tensor_as_f</span>
<span class="n">H_m</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">X_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">CN_m</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">CP_m</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">I</span> <span class="o">*</span> <span class="n">x0</span><span class="p">)]]</span>
<span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">H_m</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">X_m</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">CP</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">CP_m</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">CN</span> <span class="o">=</span> <span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">CN_m</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex256</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">hierq</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Qinit</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">tensors</span><span class="o">=</span><span class="n">tensors</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">H</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">CP_m</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">CP_m</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">CN_m</span><span class="p">),</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">CP_m</span><span class="p">),</span> <span class="n">symbols</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">Qunitary</span><span class="p">(</span><span class="n">get_tensor_as_f</span><span class="p">(</span><span class="n">CN_m</span><span class="p">),</span> <span class="n">arity</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">Qmotif</span><span class="p">(</span><span class="n">E</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,)],</span> <span class="n">mapping</span><span class="o">=</span><span class="n">H</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">plot_circuit</span><span class="p">(</span><span class="n">hierq</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hierq</span><span class="p">()</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0e3c2278e06d6c8497b566ebdb4c73c181db62ec0523f95764a9b871b17563ae.png" src="../_images/0e3c2278e06d6c8497b566ebdb4c73c181db62ec0523f95764a9b871b17563ae.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.+0.000000e+00j 0.+0.000000e+00j 0.+0.000000e+00j 0.+0.000000e+00j
 0.+0.000000e+00j 0.+0.000000e+00j 0.+6.123234e-17j 1.-6.123234e-17j]
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="HierarQcal Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Matt Lourens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>